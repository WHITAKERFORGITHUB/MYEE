<!DOCTYPE html>
<html lang="en">
<head>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <script>
		$(function() {
			let idValue = localStorage.getItem("id");
			if (idValue != null && idValue != ''){
				$("input[name=id]").val(idValue);
			}
			let $chkObj = $("input[type=checkbox]");
			
			let $formObj = $("form");
			$formObj.submit(function(event) {
				// alert('test')
				if($chkObj.prop("checked")) {
					let $idObj = $("input[name=id]");
					localStorage.setItem("id", $idObj.val());
				} else {
					localStorage.removeItem("id");
				}
				var idValue = $("input[name=id]").val();
				var pwdValue = $("input[name=pwd]").val();
				
				$.ajax({ 	
                	url: "./login",
                	method: "post",
                	data: {"id": idValue, "pwd": pwdValue},
                	success: function(responseObj){
                		
                		console.log(responseObj)
                		
                		// 이미 application/json 형태로 서버에서 전달해주었으므로, .parse() 필요없음
                		if(responseObj.status == 1) {
                			alert("로그인 성공");
                		} else {
                			alert("로그인 실패");
                		}
                	},
                	error: function(jqXHR){
                		alert(jqXHR.status);
                	}
                })
                return false; 	
			})
		})
    </script>
</head>
<body> 
    <div class="login">
        <form action="">
            <label for="">아이디: <input type="text" name="id"></label><br>
            <label for="">비밀번호: <input type="password" name="pwd"></label><br>
            <label for=""><input type="checkbox" checked>아이디저장</label>
            <input type="submit" value="로그인">
        </form>
    </div>
</body>
</html>